name: ุชุญูู ุฏุงุฏูโูุง ูุงู ุชู

on:
  workflow_dispatch:  # ููุท ุงุฌุฑุง ุฏุณุช

jobs:
  analyze:
    runs-on: ubuntu-latest
    
    steps:
    # ูุฑุญูู ฑ: ุฏุฑุงูุช ฺฉุฏ
    - name: ุฏุฑุงูุช ฺฉุฏ
      uses: actions/checkout@v4  # โ ุชุบุฑ ุงุฒ v3 ุจู v4
    
    # ูุฑุญูู ฒ: ูุตุจ ูพุงุชูู
    - name: ูุตุจ ูพุงุชูู
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    # ูุฑุญูู ณ: ุงุฌุงุฏ ูพูุดูโูุง
    - name: ุงุฌุงุฏ ูพูุดูโูุง
      run: |
        mkdir -p data
        mkdir -p results
        echo "๐ ูพูุดูโูุง ุงุฌุงุฏ ุดุฏูุฏ"
        ls -la
    
    # ูุฑุญูู ด: ุงุฌุฑุง ุชุญูู
    - name: ุงุฌุฑุง ุชุญูู
      env:
        COPERNICUS_USERNAME: ${{ secrets.COPERNICUS_USERNAME }}
        COPERNICUS_PASSWORD: ${{ secrets.COPERNICUS_PASSWORD }}
      run: |
        echo "๐ฌ ุดุฑูุน ุงุฌุฑุง ุงุณฺฉุฑูพุช..."
        python backend/run_daily.py
    
    # ูุฑุญูู ต: ููุงุด ูุชุงุฌ
    - name: ููุงุด ูุชุงุฌ
      run: |
        echo ""
        echo "๐ ูุชุงุฌ ุงุฌุฑุง:"
        echo "--------------"
        if ls results/*.txt 1> /dev/null 2>&1; then
          echo "โ ูุงูโูุง ุงุฌุงุฏ ุดุฏู:"
          ls -la results/*.txt
          echo ""
          echo "๐ ูุญุชูุง ุขุฎุฑู ูุงู:"
          cat results/$(ls -t results/*.txt | head -1)
        else
          echo "โ ูฺ ูุงู ุงุฌุงุฏ ูุดุฏ"
        fi
    
    # ูุฑุญูู ถ: ุฐุฎุฑู ูุชุงุฌ - โ ุชุบุฑ ุงุฒ v3 ุจู v4
    - name: ุฐุฎุฑู ูุชุงุฌ
      uses: actions/upload-artifact@v4
      with:
        name: ูุชุงุฌ-ุชุญูู
        path: results/
